Regression_Cntry_nbr <- Inequality_on_conflict$N_countries
odd_indexes<-seq(1,15,2)
Regression_Cntry_nbr <- Regression_Cntry_nbr[-odd_indexes]
Regression_labels <- unique(Inequality_on_conflict$labels)
Regression_labels <- paste0(as.factor(Regression_labels)," (" ,as.factor(Regression_Cntry_nbr),")")
Regression_name_pos = nn*2 - 0.5
Regression_name_pos = Regression_name_pos[Regression_name_pos < 16]
#Set the number of observations
Regression_Obs_nbr <- unique(Inequality_on_conflict$Obs)
#Set the estimate figures Confidence interval
Regression_CI <- paste0("(",round(Inequality_on_conflict$lo_c, digits = 2),"; ",round(Inequality_on_conflict$hi_c, digits = 2),")")
#Plotting the figure ----
#Plot an empty figure with the dimension of the dataframe
plot(1,type="n",xlim=c(-0.31,0.31),ylim=c(0,dim(Inequality_on_conflict)[1]+2),axes=F,ylab="",xlab="")
#The title of the axis
mtext(side = 1, text = expression("             Effect of a standard deviation increase in rainfall"), line=2.5, cex = 0.8)
mtext(side = 1, text = "             relative to national average on armed conflicts", line=3, cex = 0.8)
#Insert vertical grid lines
abline(v=xx,lwd=0.5,col="grey",lty=2)
abline(v=0,lwd=0.5, col="red")
#Inserting the coefficients and the standard errors
segments(Inequality_on_conflict$lo_c,nn,Inequality_on_conflict$hi_c, nn, cex=marker_size, lwd = 2, col = "grey")
points(Inequality_on_conflict$beta,nn,pch=21,bg=Inequality_on_conflict$Color,cex=marker_size)
#setting subgroups in the graph and the axis grid
abline(h=lz,lwd=1,lty=1,col="grey") #with subgroup ordering
axis(1,at=seq(-0.05,0.1,0.025),labels=seq(-0.05,0.1,0.025), cex.axis=axis_size_text,line=0)
for (i in seq(0,24,4)){
panel.first = rect(-0.5,i+0.5,0.5,i+2.5,col = rgb(0.9,0.9,0.9,1/4), border=NA)
}
#Including the text on the left side of the graph
text(x= -0.33, y=17, labels = "Sample (No. countries)", cex=title_size_text, font=2, pos=4)
text(x= -0.18, y=17, labels = "Obs.", cex=title_size_text, font=2, pos=4)
text(x= -0.13, y=17, labels = "Total conflict\nincidence/onset", cex=title_size_text, font=2, adj = c(0,0.1))
text(x= -0.33, y =Regression_name_pos, labels = Regression_labels, cex=figure_size_text, font=1, pos=4)
text(x= -0.18, y =Regression_name_pos, labels = Regression_Obs_nbr, cex=figure_size_text, font=1,pos=4)
text(x= -0.13, y =nn, labels =Inequality_on_conflict$Occurence, cex=figure_size_text, font=1,pos=4)
text(x= Inequality_on_conflict$beta, y=nn+0.25, labels= round(Inequality_on_conflict$beta, digits = 2), cex=marker_text_size, font=1, pos=4)
text(x= Inequality_on_conflict$beta+0.011, y=nn+0.3, labels= Inequality_on_conflict$statistical_level, cex=marker_text_size, font=1, pos=4)
#Including the legend
points(x=-0.32,y=0.2,pch=21,bg="White",cex=marker_size)
points(x=-0.32,y=-0.4,pch=21,bg="Black",cex=marker_size)
text(x= -0.32, y=0.2, labels= "Impact on conflict incidence", cex=figure_size_text, font=3, pos=4)
text(x= -0.32, y=-0.4, labels= "Impact on conflict onset", cex=figure_size_text, font=3, pos=4)
rm(x)
#Importing the data ----
setwd("Desktop/Armed_conflicts/Analysis/Code")
df_coeff = read.csv("../Output/Data_for_R_plot.csv")
df_coeff$Color[df_coeff$Onset_Incidence == "_onset"] <- "black"
df_coeff$Color[df_coeff$Onset_Incidence == "_incidence"] <- "white"
df_coeff$labels[df_coeff$labels == "Low agriculture dependence"] <- "Low dependence\nto agriculture"
df_coeff$labels[df_coeff$labels == "High agriculture dependence"] <- "High dependence\nto agriculture"
df_coeff$labels[df_coeff$labels == "Low manufacture dependence"] <- "Low dependence\nto manufacturing"
df_coeff$labels[df_coeff$labels == "High manufacture dependence"] <- "High dependence\nto manufacturing"
df_coeff$labels[df_coeff$labels == "Low service dependence"] <- "Low dependence\nto service"
df_coeff$labels[df_coeff$labels == "High service dependence"] <- "High dependence\nto service"
df_coeff$statistical_level[df_coeff$pvalue > 0.1] <- " "
df_coeff$statistical_level[(df_coeff$pvalue < 0.1) & (df_coeff$pvalue > 0.05)] <- "*"
df_coeff$statistical_level[(df_coeff$pvalue < 0.05) & (df_coeff$pvalue > 0.01)] <- "**"
df_coeff$statistical_level[df_coeff$pvalue < 0.01] <- "***"
df_coeff$statistical_level[df_coeff$pvalue > 0.1] <- " "
df_coeff$statistical_level[(df_coeff$pvalue < 0.1) & (df_coeff$pvalue > 0.05)] <- "*"
df_coeff$statistical_level[(df_coeff$pvalue < 0.05) & (df_coeff$pvalue > 0.01)] <- "**"
df_coeff$statistical_level[df_coeff$pvalue < 0.01] <- "***"
#Figure -----
#Selecting meaningful data
df_coeff <- df_coeff[!(df_coeff$labels=="Low service dependence" | df_coeff$labels=="Low agriculture dependence" | df_coeff$labels=="Low manufacture dependence" | df_coeff$labels=="High income"),]
dim(Inequality_on_conflict)[1]
lz
#horizontal break lines to divide samples
lz <- seq(2.5,16.5,2)
lz
##Drawing the figure for the effects of rainfall endowments on conflicts ----
###Set the inner variables ----
#text_size
marker_size = 2
axis_size_text = 0.7
Big_title_size_text = 1.1
title_size_text = 1
marker_text_size = title_size_text - 0.3
figure_size_text = 0.9
#horizontal lines
xx <- seq(-0.05,0.1,0.025)
#The position of coefficients
nn=nrow(Inequality_on_conflict):1
#horizontal break lines to divide samples
lz <- seq(2.5,16.5,2)
#Sample labels for each regression
Regression_Cntry_nbr <- Inequality_on_conflict$N_countries
odd_indexes<-seq(1,15,2)
Regression_Cntry_nbr <- Regression_Cntry_nbr[-odd_indexes]
Regression_labels <- unique(Inequality_on_conflict$labels)
Regression_labels <- paste0(as.factor(Regression_labels)," (" ,as.factor(Regression_Cntry_nbr),")")
Regression_name_pos = nn*2 - 0.5
Regression_name_pos = Regression_name_pos[Regression_name_pos < 16]
#Number of observations
Regression_Obs_nbr <- unique(Inequality_on_conflict$Obs)
#Confidence interval
Regression_CI <- paste0("(",round(Inequality_on_conflict$lo_c, digits = 2),"; ",round(Inequality_on_conflict$hi_c, digits = 2),")")
###Plotting the figure ----
#Plot an empty figure with the dimension of the dataframe
plot(1,type="n",xlim=c(-0.31,0.31),ylim=c(0,dim(Inequality_on_conflict)[1]+2),axes=F,ylab="",xlab="")
#The title of the axis
mtext(side = 1, text = expression("             Effect of a standard deviation increase in rainfall"), line=2.5, cex = 0.8)
mtext(side = 1, text = "             relative to national average on armed conflicts", line=3, cex = 0.8)
#Insert vertical grid lines
abline(v=xx,lwd=0.5,col="grey",lty=2)
abline(v=0,lwd=0.5, col="red")
#Inserting the coefficients and the standard errors
segments(Inequality_on_conflict$lo_c,nn,Inequality_on_conflict$hi_c, nn, cex=marker_size, lwd = 2, col = "grey")
points(Inequality_on_conflict$beta,nn,pch=21,bg=Inequality_on_conflict$Color,cex=marker_size)
#setting subgroups in the graph and the axis grid
abline(h=lz,lwd=1,lty=1,col="grey") #with subgroup ordering
axis(1,at=seq(-0.05,0.1,0.025),labels=seq(-0.05,0.1,0.025), cex.axis=axis_size_text,line=0)
for (i in seq(0,24,4)){
panel.first = rect(-0.5,i+0.5,0.5,i+2.5,col = rgb(0.9,0.9,0.9,1/4), border=NA)
}
#Including the text on the left side of the graph
text(x= -0.33, y=17, labels = "Sample (No. countries)", cex=title_size_text, font=2, pos=4)
text(x= -0.18, y=17, labels = "Obs.", cex=title_size_text, font=2, pos=4)
text(x= -0.13, y=17, labels = "Total conflict\nincidence/onset", cex=title_size_text, font=2, adj = c(0,0.1))
text(x= -0.33, y =Regression_name_pos, labels = Regression_labels, cex=figure_size_text, font=1, pos=4)
text(x= -0.18, y =Regression_name_pos, labels = Regression_Obs_nbr, cex=figure_size_text, font=1,pos=4)
text(x= -0.13, y =nn, labels =Inequality_on_conflict$Occurence, cex=figure_size_text, font=1,pos=4)
text(x= Inequality_on_conflict$beta, y=nn+0.25, labels= round(Inequality_on_conflict$beta, digits = 2), cex=marker_text_size, font=1, pos=4)
text(x= Inequality_on_conflict$beta+0.011, y=nn+0.3, labels= Inequality_on_conflict$statistical_level, cex=marker_text_size, font=1, pos=4)
#Including the legend
points(x=-0.32,y=0.2,pch=21,bg="White",cex=marker_size)
points(x=-0.32,y=-0.4,pch=21,bg="Black",cex=marker_size)
text(x= -0.32, y=0.2, labels= "Impact on conflict incidence", cex=figure_size_text, font=3, pos=4)
text(x= -0.32, y=-0.4, labels= "Impact on conflict onset", cex=figure_size_text, font=3, pos=4)
inequality_plot <- recordPlot()
# Combining figures ----
# make labels and margins smaller
par(cex=0.7, mai=c(0.05,0.05,0.05,0.05))
# define area of the left plot
par(fig=c(0.1,0.7,0.1,0.9))
inequality_plot
# define area for the second plot
par(fig=c(0.6,1,0,1), new=TRUE)
# draw the second plot
plot(1,type="n",xlim=c(-0.1,0.1),ylim=c(0,dim(Pre_on_conflict)[1]+2),axes=F,ylab="",xlab="")
#The title of the axis
mtext(side = 1, text = expression("                    Effect of a statndard deviation increase in rainfall"), line=2.5, cex = 0.8)
mtext(side = 1, text = "               relative to long-term regional average on armed conflicts", line=3, cex = 0.8)
#Insert vertical grid lines
abline(v=xx,lwd=0.5,col="grey",lty=2)
abline(v=0,lwd=0.5, col="red")
#Inserting the coefficients and the standard errors
segments(Pre_on_conflict$lo_c,nn,Pre_on_conflict$hi_c, nn, cex=marker_size, lwd = 2, col = "grey")
points(Pre_on_conflict$beta,nn,pch=21,bg=Pre_on_conflict$Color,cex=marker_size)
#setting subgroups in the graph and the axis grid
abline(h=lz,lwd=1,lty=1,col="grey") #with subgroup ordering
axis(1,at=seq(-0.05,0.1,0.025),labels=seq(-0.05,0.1,0.025), cex.axis=axis_size_text,line=0)
#Including the text on the left side of the graph
text(x= Pre_on_conflict$beta, y=nn+0.25, labels= round(Pre_on_conflict$beta, digits = 2), cex=marker_text_size, font=1, pos=4)
text(x= Pre_on_conflict$beta+0.011, y=nn+0.3, labels= Pre_on_conflict$statistical_level, cex=marker_text_size, font=1, pos=4)
#Importing the data ----
setwd("Desktop/Armed_conflicts/Analysis/Code")
df_coeff = read.csv("../Output/Data_for_R_plot.csv")
df_coeff$Color[df_coeff$Onset_Incidence == "_onset"] <- "black"
df_coeff$Color[df_coeff$Onset_Incidence == "_incidence"] <- "white"
df_coeff$labels[df_coeff$labels == "Low agriculture dependence"] <- "Low dependence\nto agriculture"
df_coeff$labels[df_coeff$labels == "High agriculture dependence"] <- "High dependence\nto agriculture"
df_coeff$labels[df_coeff$labels == "Low manufacture dependence"] <- "Low dependence\nto manufacturing"
df_coeff$labels[df_coeff$labels == "High manufacture dependence"] <- "High dependence\nto manufacturing"
df_coeff$labels[df_coeff$labels == "Low service dependence"] <- "Low dependence\nto service"
df_coeff$labels[df_coeff$labels == "High service dependence"] <- "High dependence\nto service"
df_coeff$statistical_level[df_coeff$pvalue > 0.1] <- " "
df_coeff$statistical_level[(df_coeff$pvalue < 0.1) & (df_coeff$pvalue > 0.05)] <- "*"
df_coeff$statistical_level[(df_coeff$pvalue < 0.05) & (df_coeff$pvalue > 0.01)] <- "**"
df_coeff$statistical_level[df_coeff$pvalue < 0.01] <- "***"
#Figure -----
#Selecting meaningful data
df_coeff <- df_coeff[!(df_coeff$labels=="Low service dependence" | df_coeff$labels=="Low agriculture dependence" | df_coeff$labels=="Low manufacture dependence" | df_coeff$labels=="High income"),]
#Redefining labels for the figure
df_coeff$labels[df_coeff$labels == "High agriculture dependence"] <- "High dependence\nto agriculture"
df_coeff$labels[df_coeff$labels == "High manufacture dependence"] <- "High dependence\nto manufacturing"
df_coeff$labels[df_coeff$labels == "High service dependence"] <- "High dependence\nto service"
#Defining stars to indicate the statistical level of significance
df_coeff$statistical_level[df_coeff$pvalue > 0.1] <- " "
df_coeff$statistical_level[(df_coeff$pvalue < 0.1) & (df_coeff$pvalue > 0.05)] <- "*"
df_coeff$statistical_level[(df_coeff$pvalue < 0.05) & (df_coeff$pvalue > 0.01)] <- "**"
df_coeff$statistical_level[df_coeff$pvalue < 0.01] <- "***"
#Defining sub-sample data for rainfall endowments
Inequality_on_conflict <-df_coeff[!(df_coeff$Inequality_level=="_z_Level"),]
#Defining sub-sample data for rainfall anomalies
Pre_on_conflict <-df_coeff[df_coeff$Inequality_level=="_z_Level",]
#Drawing the figure for the effects of rainfall endowments on conflicts ----
###Set the inner variables ----
#text_size
marker_size = 2
axis_size_text = 0.7
Big_title_size_text = 1.1
title_size_text = 1
marker_text_size = title_size_text - 0.3
figure_size_text = 0.9
#horizontal lines
xx <- seq(-0.05,0.1,0.025)
#The position of coefficients
nn=nrow(Inequality_on_conflict):1
#horizontal break lines to divide samples
lz <- seq(2.5,16.5,2)
#Sample labels for each regression
Regression_Cntry_nbr <- Inequality_on_conflict$N_countries
odd_indexes<-seq(1,15,2)
Regression_Cntry_nbr <- Regression_Cntry_nbr[-odd_indexes]
Regression_labels <- unique(Inequality_on_conflict$labels)
Regression_labels <- paste0(as.factor(Regression_labels)," (" ,as.factor(Regression_Cntry_nbr),")")
Regression_name_pos = nn*2 - 0.5
Regression_name_pos = Regression_name_pos[Regression_name_pos < 16]
#Number of observations
Regression_Obs_nbr <- unique(Inequality_on_conflict$Obs)
#Confidence interval
Regression_CI <- paste0("(",round(Inequality_on_conflict$lo_c, digits = 2),"; ",round(Inequality_on_conflict$hi_c, digits = 2),")")
###Plotting the first figure ----
#Plot an empty figure with the dimension of the dataframe
plot(1,type="n",xlim=c(-0.31,0.31),ylim=c(0,dim(Inequality_on_conflict)[1]+2),axes=F,ylab="",xlab="")
#The title of the axis
mtext(side = 1, text = expression("             Effect of a standard deviation increase in rainfall"), line=2.5, cex = 0.8)
mtext(side = 1, text = "             relative to national average on armed conflicts", line=3, cex = 0.8)
#Insert vertical grid lines
abline(v=xx,lwd=0.5,col="grey",lty=2)
abline(v=0,lwd=0.5, col="red")
#Inserting the coefficients and the standard errors
segments(Inequality_on_conflict$lo_c,nn,Inequality_on_conflict$hi_c, nn, cex=marker_size, lwd = 2, col = "grey")
points(Inequality_on_conflict$beta,nn,pch=21,bg=Inequality_on_conflict$Color,cex=marker_size)
#setting subgroups in the graph and the axis grid
abline(h=lz,lwd=1,lty=1,col="grey") #with subgroup ordering
axis(1,at=seq(-0.05,0.1,0.025),labels=seq(-0.05,0.1,0.025), cex.axis=axis_size_text,line=0)
for (i in seq(0,24,4)){
panel.first = rect(-0.5,i+0.5,0.5,i+2.5,col = rgb(0.9,0.9,0.9,1/4), border=NA)
}
#Including the text on the left side of the graph
text(x= -0.33, y=17, labels = "Sample (No. countries)", cex=title_size_text, font=2, pos=4)
text(x= -0.18, y=17, labels = "Obs.", cex=title_size_text, font=2, pos=4)
text(x= -0.13, y=17, labels = "Total conflict\nincidence/onset", cex=title_size_text, font=2, adj = c(0,0.1))
text(x= -0.33, y =Regression_name_pos, labels = Regression_labels, cex=figure_size_text, font=1, pos=4)
text(x= -0.18, y =Regression_name_pos, labels = Regression_Obs_nbr, cex=figure_size_text, font=1,pos=4)
text(x= -0.13, y =nn, labels =Inequality_on_conflict$Occurence, cex=figure_size_text, font=1,pos=4)
text(x= Inequality_on_conflict$beta, y=nn+0.25, labels= round(Inequality_on_conflict$beta, digits = 2), cex=marker_text_size, font=1, pos=4)
text(x= Inequality_on_conflict$beta+0.011, y=nn+0.3, labels= Inequality_on_conflict$statistical_level, cex=marker_text_size, font=1, pos=4)
#Including the legend
points(x=-0.32,y=0.2,pch=21,bg="White",cex=marker_size)
points(x=-0.32,y=-0.4,pch=21,bg="Black",cex=marker_size)
text(x= -0.32, y=0.2, labels= "Impact on conflict incidence", cex=figure_size_text, font=3, pos=4)
text(x= -0.32, y=-0.4, labels= "Impact on conflict onset", cex=figure_size_text, font=3, pos=4)
#save the first plot
inequality_plot <- recordPlot()
###Plotting the second figure and combining the figures ----
# make labels and margins smaller
par(cex=0.7, mai=c(0.05,0.05,0.05,0.05))
# define area of the left plot
par(fig=c(0.1,0.7,0.1,0.9))
inequality_plot
# define area for the second plot
par(fig=c(0.6,1,0,1), new=TRUE)
# draw the second plot
plot(1,type="n",xlim=c(-0.1,0.1),ylim=c(0,dim(Pre_on_conflict)[1]+2),axes=F,ylab="",xlab="")
#The title of the axis
mtext(side = 1, text = expression("                    Effect of a statndard deviation increase in rainfall"), line=2.5, cex = 0.8)
mtext(side = 1, text = "               relative to long-term regional average on armed conflicts", line=3, cex = 0.8)
#Insert vertical grid lines
abline(v=xx,lwd=0.5,col="grey",lty=2)
abline(v=0,lwd=0.5, col="red")
#Inserting the coefficients and the standard errors
segments(Pre_on_conflict$lo_c,nn,Pre_on_conflict$hi_c, nn, cex=marker_size, lwd = 2, col = "grey")
points(Pre_on_conflict$beta,nn,pch=21,bg=Pre_on_conflict$Color,cex=marker_size)
#setting subgroups in the graph and the axis grid
abline(h=lz,lwd=1,lty=1,col="grey") #with subgroup ordering
axis(1,at=seq(-0.05,0.1,0.025),labels=seq(-0.05,0.1,0.025), cex.axis=axis_size_text,line=0)
#Including the text on the left side of the graph
text(x= Pre_on_conflict$beta, y=nn+0.25, labels= round(Pre_on_conflict$beta, digits = 2), cex=marker_text_size, font=1, pos=4)
text(x= Pre_on_conflict$beta+0.011, y=nn+0.3, labels= Pre_on_conflict$statistical_level, cex=marker_text_size, font=1, pos=4)
dim(df_coeff)
dim(Inequality_on_conflict)
View(Inequality_on_conflict)
#Figure -----
#Selecting meaningful data
df_coeff <- df_coeff[!(df_coeff$labels=="Low service dependence" | df_coeff$labels=="Low agriculture dependence" | df_coeff$labels=="Low manufacture dependence" | df_coeff$labels=="High income"),]
View(df_coeff)
#Figure -----
#Selecting meaningful data
df_coeff_1 <- df_coeff[!(df_coeff$labels=="Low service dependence" | df_coeff$labels=="Low agriculture dependence" | df_coeff$labels=="Low manufacture dependence" | df_coeff$labels=="High income"),]
df_coeff = read.csv("../Output/Data_for_R_plot.csv")
#Figure -----
#Selecting meaningful data
df_coeff <- df_coeff[!(df_coeff$labels=="Low service dependence" | df_coeff$labels=="Low agriculture dependence" | df_coeff$labels=="Low manufacture dependence" | df_coeff$labels=="High income"),]
rm(df_coeff_1)
f_coeff = read.csv("../Output/Data_for_R_plot.csv")
df_coeff$Color[df_coeff$Onset_Incidence == "_onset"] <- "black"
df_coeff$Color[df_coeff$Onset_Incidence == "_incidence"] <- "white"
df_coeff$labels[df_coeff$labels == "High agriculture dependence"] <- "High dependence\nto agriculture"
df_coeff$labels[df_coeff$labels == "High manufacture dependence"] <- "High dependence\nto manufacturing"
df_coeff$labels[df_coeff$labels == "High service dependence"] <- "High dependence\nto service"
df_coeff$statistical_level[df_coeff$pvalue > 0.1] <- " "
df_coeff$statistical_level[(df_coeff$pvalue < 0.1) & (df_coeff$pvalue > 0.05)] <- "*"
df_coeff$statistical_level[(df_coeff$pvalue < 0.05) & (df_coeff$pvalue > 0.01)] <- "**"
df_coeff$statistical_level[df_coeff$pvalue < 0.01] <- "***"
#Figure -----
#Selecting meaningful data
df_coeff <- df_coeff[!(df_coeff$labels=="Low service dependence" | df_coeff$labels=="Low agriculture dependence" | df_coeff$labels=="Low manufacture dependence" | df_coeff$labels=="High income"),]
#Redefining labels for the figure
df_coeff$labels[df_coeff$labels == "High agriculture dependence"] <- "High dependence\nto agriculture"
df_coeff$labels[df_coeff$labels == "High manufacture dependence"] <- "High dependence\nto manufacturing"
df_coeff$labels[df_coeff$labels == "High service dependence"] <- "High dependence\nto service"
#Defining stars to indicate the statistical level of significance
df_coeff$statistical_level[df_coeff$pvalue > 0.1] <- " "
df_coeff$statistical_level[(df_coeff$pvalue < 0.1) & (df_coeff$pvalue > 0.05)] <- "*"
df_coeff$statistical_level[(df_coeff$pvalue < 0.05) & (df_coeff$pvalue > 0.01)] <- "**"
df_coeff$statistical_level[df_coeff$pvalue < 0.01] <- "***"
#Defining sub-sample data for rainfall endowments
Inequality_on_conflict <-df_coeff[!(df_coeff$Inequality_level=="_z_Level"),]
#Defining sub-sample data for rainfall anomalies
Pre_on_conflict <-df_coeff[df_coeff$Inequality_level=="_z_Level",]
#Drawing the figure for the effects of rainfall endowments on conflicts ----
###Set the inner variables ----
#text_size
marker_size = 2
axis_size_text = 0.7
Big_title_size_text = 1.1
title_size_text = 1
marker_text_size = title_size_text - 0.3
figure_size_text = 0.9
#horizontal lines
xx <- seq(-0.05,0.1,0.025)
#The position of coefficients
nn=nrow(Inequality_on_conflict):1
#horizontal break lines to divide samples
lz <- seq(2.5,16.5,2)
#Sample labels for each regression
Regression_Cntry_nbr <- Inequality_on_conflict$N_countries
odd_indexes<-seq(1,15,2)
Regression_Cntry_nbr <- Regression_Cntry_nbr[-odd_indexes]
Regression_labels <- unique(Inequality_on_conflict$labels)
Regression_labels <- paste0(as.factor(Regression_labels)," (" ,as.factor(Regression_Cntry_nbr),")")
Regression_name_pos = nn*2 - 0.5
Regression_name_pos = Regression_name_pos[Regression_name_pos < 16]
#Number of observations
Regression_Obs_nbr <- unique(Inequality_on_conflict$Obs)
#Confidence interval
Regression_CI <- paste0("(",round(Inequality_on_conflict$lo_c, digits = 2),"; ",round(Inequality_on_conflict$hi_c, digits = 2),")")
###Plotting the first figure ----
#Plot an empty figure with the dimension of the dataframe
plot(1,type="n",xlim=c(-0.31,0.31),ylim=c(0,dim(Inequality_on_conflict)[1]+2),axes=F,ylab="",xlab="")
#The title of the axis
mtext(side = 1, text = expression("             Effect of a standard deviation increase in rainfall"), line=2.5, cex = 0.8)
mtext(side = 1, text = "             relative to national average on armed conflicts", line=3, cex = 0.8)
#Insert vertical grid lines
abline(v=xx,lwd=0.5,col="grey",lty=2)
abline(v=0,lwd=0.5, col="red")
#Inserting the coefficients and the standard errors
segments(Inequality_on_conflict$lo_c,nn,Inequality_on_conflict$hi_c, nn, cex=marker_size, lwd = 2, col = "grey")
points(Inequality_on_conflict$beta,nn,pch=21,bg=Inequality_on_conflict$Color,cex=marker_size)
#setting subgroups in the graph and the axis grid
abline(h=lz,lwd=1,lty=1,col="grey") #with subgroup ordering
axis(1,at=seq(-0.05,0.1,0.025),labels=seq(-0.05,0.1,0.025), cex.axis=axis_size_text,line=0)
for (i in seq(0,24,4)){
panel.first = rect(-0.5,i+0.5,0.5,i+2.5,col = rgb(0.9,0.9,0.9,1/4), border=NA)
}
#Including the text on the left side of the graph
text(x= -0.33, y=17, labels = "Sample (No. countries)", cex=title_size_text, font=2, pos=4)
text(x= -0.18, y=17, labels = "Obs.", cex=title_size_text, font=2, pos=4)
text(x= -0.13, y=17, labels = "Total conflict\nincidence/onset", cex=title_size_text, font=2, adj = c(0,0.1))
text(x= -0.33, y =Regression_name_pos, labels = Regression_labels, cex=figure_size_text, font=1, pos=4)
text(x= -0.18, y =Regression_name_pos, labels = Regression_Obs_nbr, cex=figure_size_text, font=1,pos=4)
text(x= -0.13, y =nn, labels =Inequality_on_conflict$Occurence, cex=figure_size_text, font=1,pos=4)
text(x= Inequality_on_conflict$beta, y=nn+0.25, labels= round(Inequality_on_conflict$beta, digits = 2), cex=marker_text_size, font=1, pos=4)
text(x= Inequality_on_conflict$beta+0.011, y=nn+0.3, labels= Inequality_on_conflict$statistical_level, cex=marker_text_size, font=1, pos=4)
#Including the legend
points(x=-0.32,y=0.2,pch=21,bg="White",cex=marker_size)
points(x=-0.32,y=-0.4,pch=21,bg="Black",cex=marker_size)
text(x= -0.32, y=0.2, labels= "Impact on conflict incidence", cex=figure_size_text, font=3, pos=4)
text(x= -0.32, y=-0.4, labels= "Impact on conflict onset", cex=figure_size_text, font=3, pos=4)
#save the first plot
inequality_plot <- recordPlot()
###Plotting the second figure and combining the figures ----
# make labels and margins smaller
par(cex=0.7, mai=c(0.05,0.05,0.05,0.05))
# define area of the left plot
par(fig=c(0.1,0.7,0.1,0.9))
inequality_plot
# define area for the second plot
par(fig=c(0.6,1,0,1), new=TRUE)
# draw the second plot
plot(1,type="n",xlim=c(-0.1,0.1),ylim=c(0,dim(Pre_on_conflict)[1]+2),axes=F,ylab="",xlab="")
#The title of the axis
mtext(side = 1, text = expression("                    Effect of a statndard deviation increase in rainfall"), line=2.5, cex = 0.8)
mtext(side = 1, text = "               relative to long-term regional average on armed conflicts", line=3, cex = 0.8)
#Insert vertical grid lines
abline(v=xx,lwd=0.5,col="grey",lty=2)
abline(v=0,lwd=0.5, col="red")
#Inserting the coefficients and the standard errors
segments(Pre_on_conflict$lo_c,nn,Pre_on_conflict$hi_c, nn, cex=marker_size, lwd = 2, col = "grey")
points(Pre_on_conflict$beta,nn,pch=21,bg=Pre_on_conflict$Color,cex=marker_size)
#setting subgroups in the graph and the axis grid
abline(h=lz,lwd=1,lty=1,col="grey") #with subgroup ordering
axis(1,at=seq(-0.05,0.1,0.025),labels=seq(-0.05,0.1,0.025), cex.axis=axis_size_text,line=0)
#Including the text on the left side of the graph
text(x= Pre_on_conflict$beta, y=nn+0.25, labels= round(Pre_on_conflict$beta, digits = 2), cex=marker_text_size, font=1, pos=4)
text(x= Pre_on_conflict$beta+0.011, y=nn+0.3, labels= Pre_on_conflict$statistical_level, cex=marker_text_size, font=1, pos=4)
f_coeff = read.csv("../Output/Data_for_R_plot.csv")
df_coeff$Color[df_coeff$Onset_Incidence == "_onset"] <- "black"
df_coeff$Color[df_coeff$Onset_Incidence == "_incidence"] <- "white"
df_coeff$labels[df_coeff$labels == "High agriculture dependence"] <- "High dependence\nto agriculture"
df_coeff$labels[df_coeff$labels == "High manufacture dependence"] <- "High dependence\nto manufacturing"
df_coeff$labels[df_coeff$labels == "High service dependence"] <- "High dependence\nto service"
df_coeff$statistical_level[df_coeff$pvalue > 0.1] <- " "
df_coeff$statistical_level[(df_coeff$pvalue < 0.1) & (df_coeff$pvalue > 0.05)] <- "*"
df_coeff$statistical_level[(df_coeff$pvalue < 0.05) & (df_coeff$pvalue > 0.01)] <- "**"
df_coeff$statistical_level[df_coeff$pvalue < 0.01] <- "***"
#Figure -----
#Selecting meaningful data
df_coeff <- df_coeff[!(df_coeff$labels=="Low service dependence" | df_coeff$labels=="Low agriculture dependence" | df_coeff$labels=="Low manufacture dependence" | df_coeff$labels=="High income"),]
#Redefining labels for the figure
df_coeff$labels[df_coeff$labels == "High agriculture dependence"] <- "High dependence\nto agriculture"
df_coeff$labels[df_coeff$labels == "High manufacture dependence"] <- "High dependence\nto manufacturing"
df_coeff$labels[df_coeff$labels == "High service dependence"] <- "High dependence\nto service"
#Defining stars to indicate the statistical level of significance
df_coeff$statistical_level[df_coeff$pvalue > 0.1] <- " "
df_coeff$statistical_level[(df_coeff$pvalue < 0.1) & (df_coeff$pvalue > 0.05)] <- "*"
df_coeff$statistical_level[(df_coeff$pvalue < 0.05) & (df_coeff$pvalue > 0.01)] <- "**"
df_coeff$statistical_level[df_coeff$pvalue < 0.01] <- "***"
#Defining sub-sample data for rainfall endowments
Inequality_on_conflict <-df_coeff[!(df_coeff$Inequality_level=="_z_Level"),]
#Defining sub-sample data for rainfall anomalies
Pre_on_conflict <-df_coeff[df_coeff$Inequality_level=="_z_Level",]
#Drawing the figure for the effects of rainfall endowments on conflicts ----
###Set the inner variables ----
#text_size
marker_size = 2
axis_size_text = 0.7
Big_title_size_text = 1.1
title_size_text = 1
marker_text_size = title_size_text - 0.3
figure_size_text = 0.9
#horizontal lines
xx <- seq(-0.05,0.1,0.025)
#The position of coefficients
nn=nrow(Inequality_on_conflict):1
#horizontal break lines to divide samples
lz <- seq(2.5,16.5,2)
#Sample labels for each regression
Regression_Cntry_nbr <- Inequality_on_conflict$N_countries
odd_indexes<-seq(1,15,2)
Regression_Cntry_nbr <- Regression_Cntry_nbr[-odd_indexes]
Regression_labels <- unique(Inequality_on_conflict$labels)
Regression_labels <- paste0(as.factor(Regression_labels)," (" ,as.factor(Regression_Cntry_nbr),")")
Regression_name_pos = nn*2 - 0.5
Regression_name_pos = Regression_name_pos[Regression_name_pos < 16]
#Number of observations
Regression_Obs_nbr <- unique(Inequality_on_conflict$Obs)
#Confidence interval
Regression_CI <- paste0("(",round(Inequality_on_conflict$lo_c, digits = 2),"; ",round(Inequality_on_conflict$hi_c, digits = 2),")")
###Plotting the first figure ----
#Plot an empty figure with the dimension of the dataframe
plot(1,type="n",xlim=c(-0.31,0.31),ylim=c(0,dim(Inequality_on_conflict)[1]+2),axes=F,ylab="",xlab="")
#The title of the axis
mtext(side = 1, text = expression("             Effect of a standard deviation increase in rainfall"), line=2.5, cex = 0.8)
mtext(side = 1, text = "             relative to national average on armed conflicts", line=3, cex = 0.8)
#Insert vertical grid lines
abline(v=xx,lwd=0.5,col="grey",lty=2)
abline(v=0,lwd=0.5, col="red")
#Inserting the coefficients and the standard errors
segments(Inequality_on_conflict$lo_c,nn,Inequality_on_conflict$hi_c, nn, cex=marker_size, lwd = 2, col = "grey")
points(Inequality_on_conflict$beta,nn,pch=21,bg=Inequality_on_conflict$Color,cex=marker_size)
#setting subgroups in the graph and the axis grid
abline(h=lz,lwd=1,lty=1,col="grey") #with subgroup ordering
axis(1,at=seq(-0.05,0.1,0.025),labels=seq(-0.05,0.1,0.025), cex.axis=axis_size_text,line=0)
for (i in seq(0,24,4)){
panel.first = rect(-0.5,i+0.5,0.5,i+2.5,col = rgb(0.9,0.9,0.9,1/4), border=NA)
}
#Including the text on the left side of the graph
text(x= -0.33, y=17, labels = "Sample (No. countries)", cex=title_size_text, font=2, pos=4)
text(x= -0.18, y=17, labels = "Obs.", cex=title_size_text, font=2, pos=4)
text(x= -0.13, y=17, labels = "Total conflict\nincidence/onset", cex=title_size_text, font=2, adj = c(0,0.1))
text(x= -0.33, y =Regression_name_pos, labels = Regression_labels, cex=figure_size_text, font=1, pos=4)
text(x= -0.18, y =Regression_name_pos, labels = Regression_Obs_nbr, cex=figure_size_text, font=1,pos=4)
text(x= -0.13, y =nn, labels =Inequality_on_conflict$Occurence, cex=figure_size_text, font=1,pos=4)
text(x= Inequality_on_conflict$beta, y=nn+0.25, labels= round(Inequality_on_conflict$beta, digits = 2), cex=marker_text_size, font=1, pos=4)
text(x= Inequality_on_conflict$beta+0.011, y=nn+0.3, labels= Inequality_on_conflict$statistical_level, cex=marker_text_size, font=1, pos=4)
#Including the legend
points(x=-0.32,y=0.2,pch=21,bg="White",cex=marker_size)
points(x=-0.32,y=-0.4,pch=21,bg="Black",cex=marker_size)
text(x= -0.32, y=0.2, labels= "Impact on conflict incidence", cex=figure_size_text, font=3, pos=4)
text(x= -0.32, y=-0.4, labels= "Impact on conflict onset", cex=figure_size_text, font=3, pos=4)
#save the first plot
inequality_plot <- recordPlot()
###Plotting the second figure and combining the figures ----
# make labels and margins smaller
par(cex=0.7, mai=c(0.05,0.05,0.05,0.05))
# define area of the left plot
par(fig=c(0.1,0.7,0.1,0.9))
inequality_plot
# define area for the second plot
par(fig=c(0.6,1,0,1), new=TRUE)
# draw the second plot
plot(1,type="n",xlim=c(-0.1,0.1),ylim=c(0,dim(Pre_on_conflict)[1]+2),axes=F,ylab="",xlab="")
#The title of the axis
mtext(side = 1, text = expression("                    Effect of a statndard deviation increase in rainfall"), line=2.5, cex = 0.8)
mtext(side = 1, text = "               relative to long-term regional average on armed conflicts", line=3, cex = 0.8)
#Insert vertical grid lines
abline(v=xx,lwd=0.5,col="grey",lty=2)
abline(v=0,lwd=0.5, col="red")
#Inserting the coefficients and the standard errors
segments(Pre_on_conflict$lo_c,nn,Pre_on_conflict$hi_c, nn, cex=marker_size, lwd = 2, col = "grey")
points(Pre_on_conflict$beta,nn,pch=21,bg=Pre_on_conflict$Color,cex=marker_size)
#setting subgroups in the graph and the axis grid
abline(h=lz,lwd=1,lty=1,col="grey") #with subgroup ordering
axis(1,at=seq(-0.05,0.1,0.025),labels=seq(-0.05,0.1,0.025), cex.axis=axis_size_text,line=0)
#Including the text on the left side of the graph
text(x= Pre_on_conflict$beta, y=nn+0.25, labels= round(Pre_on_conflict$beta, digits = 2), cex=marker_text_size, font=1, pos=4)
text(x= Pre_on_conflict$beta+0.011, y=nn+0.3, labels= Pre_on_conflict$statistical_level, cex=marker_text_size, font=1, pos=4)
